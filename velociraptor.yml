allow:
  - write=app.log
  # - read
  # - net
  - env
envFile:
  - .env

scripts:
  start:
    desc: Runs main script
    cmd: main.ts
  dev:
    desc: Starts local server
    cmd: deployctl run --libs="" --watch ./server.ts
  test: deno test
  # test: echo 'There is no test now.'
  lint: deno lint
  fmt:
    cmd: |
      FILES=$(git diff --cached --name-only --diff-filter=ACMR "*.ts")
      [ -z "$FILES" ] && exit 0
      echo "$FILES" | xargs deno fmt
      echo "$FILES" | xargs git add
    desc: Formats staged files
  ci:
    - vr lint
    - deno fmt --check
    - vr test
  pre-commit:
    cmd:
      - vr lint
      - vr fmt
    gitHook: pre-commit
